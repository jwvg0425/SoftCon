
먼저 임의의 문자열 S가 K-균등한지를 알려면 어떻게 해야 하는지 알아보자. 먼저 맨 앞에서 길이 K만큼의 부분문자열을 뽑아 1의 개수를 센다. 이제 슬라이딩 윈도우를 하며 한 칸씩 앞으로 나아간다. i번째 문자를 부분문자열에서 제외시키고, i+K번째 문자를 부분문자열에 포함시킨다. 이 과정에서 부분문자열에 포함된 1의 개수가 변하지 않으려면, i번째 문자와 i+K번째 문자가 모두 0이거나 모두 1이어야 한다는 사실을 알 수 있다. 다시 말하자면, 어떤 문자열이 K-균등하기 위해서는 거리가 K만큼 떨어진 문자는 서로 종류가 같아야 한다는 사실을 알 수 있다.

즉, N개의 정점을 만든 뒤, i번째 구간 안에서 K_i만큼 떨어져 있는 정점들을 모두 간선으로 이어준다. 이때 간선을 이어주는 것은 두 정점의 종류가 같아야 한다는 것을 의미한다. 그러면 2^(만들어진 그래프의 컴포넌트의 개수)가 답이 된다. 왜냐하면 각각의 컴포넌트는 모두 같은 종류의 문자이어야 하고, 이 문자는 0이나 1이 될 수 있기 때문이다.

이 과정은 유니언 파인드나 DFS로 구현할 수 있고, 시간복잡도는 O(NM)이다.